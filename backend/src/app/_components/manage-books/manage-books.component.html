<app-navbar title="Bücher verwalten"></app-navbar>

<div class="container my-5">
    <div *ngIf="loading" class="text-center mt-5 pt-5">
        <div class="spinner spinner-border text-primary"></div>
    </div>
    <div *ngIf="!loading">
        <button class="btn btn-primary my-3" (click)="newBook()">Neues Buch</button>
        <table class="table table-striped table-hover">
            <thead class="position-sticky bg-white">
                <tr>
                    <th>Kürzel</th>
                    <th>Cover</th>
                    <th>Name</th>
                    <th>Verlag</th>
                    <th>Fach</th>
                    <th>Sprache</th>
                    <th>Zweig</th>
                    <th>Überg.</th>
                    <th>Jgst. 5</th>
                    <th>Jgst. 6</th>
                    <th>Jgst. 7</th>
                    <th>Jgst. 8</th>
                    <th>Jgst. 9</th>
                    <th>Jgst. 10</th>
                    <th>Q11</th>
                    <th>Q12</th>
                    <th>Aktionen</th>
                </tr>
            </thead>
            <tbody>
                <tr *ngFor="let book of books">
                    <td><input class="form-control" [(ngModel)]="book.short" *ngIf="book.editing"><span *ngIf="!book.editing">{{book.short}}</span></td>
                    <td><img src="{{ apiUrl }}books/{{ book.id }}" class="card-img bookcover" alt="Cover" /></td>
                    <td><input class="form-control" [(ngModel)]="book.name" *ngIf="book.editing"><span *ngIf="!book.editing">{{book.name}}</span></td>
                    <td><input class="form-control" [(ngModel)]="book.publisher" *ngIf="book.editing"><span *ngIf="!book.editing">{{book.publisher}}</span></td>
                    <td>
                        <select class="form-select" *ngIf="book.editing" [(ngModel)]="book.subject">
                            <option *ngFor="let subject of subjects" [value]="subject">{{subject}}</option>
                        </select>
                        <span *ngIf="!book.editing">{{book.subject}}</span>
                    </td>
                    <td>
                        <select class="form-select" *ngIf="book.editing" [(ngModel)]="book.language">
                            <option value="">-</option>
                            <option value="f">Franz.</option>
                            <option value="l">Latein</option>
                        </select>
                        <span *ngIf="!book.editing">{{book.language}}</span>
                    </td>
                    <td>
                        <select class="form-select" *ngIf="book.editing" [(ngModel)]="book.branch">
                            <option value="">-</option>
                            <option value="s">sprachl.</option>
                            <option value="sf">franz. Spätbeginner</option>
                            <option value="n">naturwis.</option>
                        </select>
                        <span *ngIf="!book.editing">{{book.branch}}</span>
                    </td>
                    <td>
                        <i *ngIf="!book.editing && book.uebergang == '1'" class="fas fa-check"></i>
                        <input *ngIf="book.editing" class="form-check-input" type="checkbox" [(ngModel)]="book.uebergang">
                    </td>
                    <td>
                        <i *ngIf="!book.editing && book['5'] == '1'" class="fas fa-check"></i>
                        <input *ngIf="book.editing" class="form-check-input" type="checkbox" [(ngModel)]="book['5']">
                    </td>
                    <td>
                        <i *ngIf="!book.editing && book['6'] == '1'" class="fas fa-check"></i>
                        <input *ngIf="book.editing" class="form-check-input" type="checkbox" [(ngModel)]="book['6']">
                    </td>
                    <td>
                        <i *ngIf="!book.editing && book['7'] == '1'" class="fas fa-check"></i>
                        <input *ngIf="book.editing" class="form-check-input" type="checkbox" [(ngModel)]="book['7']">
                    </td>
                    <td>
                        <i *ngIf="!book.editing && book['8'] == '1'" class="fas fa-check"></i>
                        <input *ngIf="book.editing" class="form-check-input" type="checkbox" [(ngModel)]="book['8']">
                    </td>
                    <td>
                        <i *ngIf="!book.editing && book['9'] == '1'" class="fas fa-check"></i>
                        <input *ngIf="book.editing" class="form-check-input" type="checkbox" [(ngModel)]="book['9']">
                    </td>
                    <td>
                        <i *ngIf="!book.editing && book['10'] == '1'" class="fas fa-check"></i>
                        <input *ngIf="book.editing" class="form-check-input" type="checkbox" [(ngModel)]="book['10']">
                    </td>
                    <td>
                        <i *ngIf="!book.editing && book.Q11 == '1'" class="fas fa-check"></i>
                        <input *ngIf="book.editing" class="form-check-input" type="checkbox" [(ngModel)]="book.Q11">
                    </td>
                    <td>
                        <i *ngIf="!book.editing && book.Q12 == '1'" class="fas fa-check"></i>
                        <input *ngIf="book.editing" class="form-check-input" type="checkbox" [(ngModel)]="book.Q12">
                    </td>
                    <td>
                        <button class="btn btn-outline-success" *ngIf="!book.editing && !editing" (click)="startEditing(book)"><i class="fas fa-pen"></i></button>
                        <button class="btn btn-outline-success" *ngIf="book.editing" (click)="finishEditing(book)"><i class="fas fa-save"></i></button>
                        <button class="btn btn-outline-dark" *ngIf="book.editing" (click)="cancelEditing(book)"><i class="fas fa-times"></i></button>
                        <button class="btn btn-outline-danger" *ngIf="!book.editing && !editing" (click)="removeBook(book)"><i class="fas fa-trash"></i></button>
                    </td>
                </tr>
            </tbody>
        </table>
    </div>
</div>